---

<aside>
üí° MNIST Dataset
</aside>

<br>
</br>
<img width="727" alt="image" src="https://github.com/Dororo99/nvidia_dli/assets/136609617/ba84a117-66fe-4fe4-a878-10c376c00bd1">


- Training and Validation Data and Labels
    - x_train: ÌïôÏäµÏùÑ ÏúÑÌï¥ ÏÇ¨Ïö©ÎêòÎäî Ïù¥ÎØ∏ÏßÄ
    - y_train: x_train Îç∞Ïù¥ÌÑ∞Ïóê ÎåÄÌïú Ï†ïÎãµ ÎòêÎäî Í∏∞ÎåÄ Ï∂úÎ†• Í∞í
    - x_valid: ÌÖåÏä§Ìä∏Ïö© Ïù¥ÎØ∏ÏßÄ
    - y_valid: ÌÖåÏä§Ìä∏ Ïù¥ÎØ∏ÏßÄÏóê ÎåÄÌïú Ï†ïÎãµ ÎòêÎäî Í∏∞ÎåÄ Ï∂úÎ†• Í∞í
- Loading the Data into Memory
    - KerasÎ•º ÏÇ¨Ïö©
        
        ```python
        #import mnist by Keras
        from tensorflw.keras.datasets import mnist
        
        # the data, split between train and validation sets
        (x_train, y_train), (x_valid, y_valid) = mnist.load_data()
        
        #70000Í∞úÏùò 28x28 Îç∞Ïù¥ÌÑ∞ Ï§ë 60000Í∞úÎ•º training ÎÇòÎ®∏ÏßÄÎ•º test
        x_train.shape
        x_valid.shape
        
        #pixelÏù¥ÎØÄÎ°ú [0,255]Ïùò Í∞íÏùÑ Í∞ÄÏ†∏Ïïº Ìï®
        x_train.dtype
        x_train.min()
        x_train.max()
        x_train[0] #Ï≤´Î≤àÏß∏ Ïù¥ÎØ∏ÏßÄÎ•º arrayÎ°ú ÎÇòÌÉÄÎÇ∏Í±∞
        ```
        
        ```python
        array([[  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                  0,   0],
               [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                  0,   0],
               [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                  0,   0],
               [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                  0,   0],
               [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                  0,   0],
               [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   3,
                 18,  18,  18, 126, 136, 175,  26, 166, 255, 247, 127,   0,   0,
                  0,   0],
               [  0,   0,   0,   0,   0,   0,   0,   0,  30,  36,  94, 154, 170,
                253, 253, 253, 253, 253, 225, 172, 253, 242, 195,  64,   0,   0,
                  0,   0],
               [  0,   0,   0,   0,   0,   0,   0,  49, 238, 253, 253, 253, 253,
                253, 253, 253, 253, 251,  93,  82,  82,  56,  39,   0,   0,   0,
                  0,   0],
               [  0,   0,   0,   0,   0,   0,   0,  18, 219, 253, 253, 253, 253,
                253, 198, 182, 247, 241,   0,   0,   0,   0,   0,   0,   0,   0,
                  0,   0],
               [  0,   0,   0,   0,   0,   0,   0,   0,  80, 156, 107, 253, 253,
                205,  11,   0,  43, 154,   0,   0,   0,   0,   0,   0,   0,   0,
                  0,   0],
               [  0,   0,   0,   0,   0,   0,   0,   0,   0,  14,   1, 154, 253,
                 90,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                  0,   0],
               [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 139, 253,
                190,   2,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                  0,   0],
               [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  11, 190,
                253,  70,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                  0,   0],
               [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  35,
                241, 225, 160, 108,   1,   0,   0,   0,   0,   0,   0,   0,   0,
                  0,   0],
               [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                 81, 240, 253, 253, 119,  25,   0,   0,   0,   0,   0,   0,   0,
                  0,   0],
               [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                  0,  45, 186, 253, 253, 150,  27,   0,   0,   0,   0,   0,   0,
                  0,   0],
               [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                  0,   0,  16,  93, 252, 253, 187,   0,   0,   0,   0,   0,   0,
                  0,   0],
               [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                  0,   0,   0,   0, 249, 253, 249,  64,   0,   0,   0,   0,   0,
                  0,   0],
               [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                  0,  46, 130, 183, 253, 253, 207,   2,   0,   0,   0,   0,   0,
                  0,   0],
               [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  39,
                148, 229, 253, 253, 253, 250, 182,   0,   0,   0,   0,   0,   0,
                  0,   0],
               [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  24, 114, 221,
                253, 253, 253, 253, 201,  78,   0,   0,   0,   0,   0,   0,   0,
                  0,   0],
               [  0,   0,   0,   0,   0,   0,   0,   0,  23,  66, 213, 253, 253,
                253, 253, 198,  81,   2,   0,   0,   0,   0,   0,   0,   0,   0,
                  0,   0],
               [  0,   0,   0,   0,   0,   0,  18, 171, 219, 253, 253, 253, 253,
                195,  80,   9,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                  0,   0],
               [  0,   0,   0,   0,  55, 172, 226, 253, 253, 253, 253, 244, 133,
                 11,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                  0,   0],
               [  0,   0,   0,   0, 136, 253, 253, 253, 212, 135, 132,  16,   0,
                  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                  0,   0],
               [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                  0,   0],
               [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                  0,   0],
               [  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                  0,   0]], dtype=uint8)
        ```
        
    - matplotlib ÏÇ¨Ïö©
        
        ```python
        import matplotlib.pyplot as plt
        
        #ÏúÑÏùò Ï≤´Î≤àÏß∏ Ïù¥ÎØ∏ÏßÄÎ•º grayscale imageÎ°ú ÎÇòÌÉÄÎÇ∏Í±∞
        image = x_train[0]
        plt.imshow(image, cmap='gray') 
        ```
        
- Flattening the Image Data
    - reshape ÏÇ¨Ïö©
        
        ```python
        #28x28=784
        x_train = x_train.reshape(60000,784)
        x_valid = x_valid.reshape(10000,784)
        
        x_train.shape
        x_train[0]
        ```
        
        ```python
        array([  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                 0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                 0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                 0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                 0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                 0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                 0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                 0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                 0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                 0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                 0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                 0,   0,   0,   0,   0,   0,   0,   0,   0,   3,  18,  18,  18,
               126, 136, 175,  26, 166, 255, 247, 127,   0,   0,   0,   0,   0,
                 0,   0,   0,   0,   0,   0,   0,  30,  36,  94, 154, 170, 253,
               253, 253, 253, 253, 225, 172, 253, 242, 195,  64,   0,   0,   0,
                 0,   0,   0,   0,   0,   0,   0,   0,  49, 238, 253, 253, 253,
               253, 253, 253, 253, 253, 251,  93,  82,  82,  56,  39,   0,   0,
                 0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  18, 219, 253,
               253, 253, 253, 253, 198, 182, 247, 241,   0,   0,   0,   0,   0,
                 0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                80, 156, 107, 253, 253, 205,  11,   0,  43, 154,   0,   0,   0,
                 0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                 0,   0,   0,  14,   1, 154, 253,  90,   0,   0,   0,   0,   0,
                 0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                 0,   0,   0,   0,   0,   0,   0, 139, 253, 190,   2,   0,   0,
                 0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                 0,   0,   0,   0,   0,   0,   0,   0,   0,  11, 190, 253,  70,
                 0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                 0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  35,
               241, 225, 160, 108,   1,   0,   0,   0,   0,   0,   0,   0,   0,
                 0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                 0,   0,  81, 240, 253, 253, 119,  25,   0,   0,   0,   0,   0,
                 0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                 0,   0,   0,   0,   0,  45, 186, 253, 253, 150,  27,   0,   0,
                 0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                 0,   0,   0,   0,   0,   0,   0,   0,  16,  93, 252, 253, 187,
                 0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                 0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 249,
               253, 249,  64,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                 0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  46, 130,
               183, 253, 253, 207,   2,   0,   0,   0,   0,   0,   0,   0,   0,
                 0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  39, 148,
               229, 253, 253, 253, 250, 182,   0,   0,   0,   0,   0,   0,   0,
                 0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  24, 114,
               221, 253, 253, 253, 253, 201,  78,   0,   0,   0,   0,   0,   0,
                 0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  23,  66,
               213, 253, 253, 253, 253, 198,  81,   2,   0,   0,   0,   0,   0,
                 0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  18, 171,
               219, 253, 253, 253, 253, 195,  80,   9,   0,   0,   0,   0,   0,
                 0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,  55, 172,
               226, 253, 253, 253, 253, 244, 133,  11,   0,   0,   0,   0,   0,
                 0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
               136, 253, 253, 253, 212, 135, 132,  16,   0,   0,   0,   0,   0,
                 0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                 0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                 0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                 0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                 0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                 0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                 0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,
                 0,   0,   0,   0], dtype=uint8)
        
        #ÏúÑÏôÄ Îã§Î•¥Í≤å Ïù¥Î†áÍ≤å ÌïòÎ©¥ ÌïòÎÇòÏùò array ÏïàÏóêÏÑú ÌëúÌòÑÎê®ÏùÑ Î≥º Ïàò ÏûàÏùå
        ```
        
- Normalizing the Image Data
    - deep learning Î™®Îç∏Ïù¥ float [0,1]ÏóêÏÑú Îçî Ïûò Îã§Î§ÑÏßÄÍ∏∞ ÎïåÎ¨∏Ïóê Ïù¥ Î≤îÏúÑ ÎÇ¥Î°ú ÎÑ£Îäî Í≤ÉÏùÑ normalizationÏù¥ÎùºÍ≥† ÌïúÎã§.
        - Converting integer values to floating point values between 0 and 1 is called normalization
        
        ```python
        x_train = x_train / 255
        x_valid = x_valid / 255
        
        #Í≤∞Í≥ºÎ¨ºÏùÑ Î≥¥Ïûê
        x_train.dtype
        x_train.min()
        x_train.max()
        ```
        
- Categorically Encoding the Labels
    - KerasÎ•º Ïù¥Ïö©ÌïòÏûê
        
        ```python
        import tensorflow.keras as keras
        num_categories = 10
        
        y_train = keras.utils.to_categorical(y_train, num_categories)
        y_valid = keras.utils.to_categorical(y_valid, num_categories)
        
        y_train[0:9]
        ```
        
        ```python
        array([[0., 0., 0., 0., 0., 1., 0., 0., 0., 0.],
               [1., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 1., 0., 0., 0., 0., 0.],
               [0., 1., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 0., 0., 0., 0., 0., 0., 1.],
               [0., 0., 1., 0., 0., 0., 0., 0., 0., 0.],
               [0., 1., 0., 0., 0., 0., 0., 0., 0., 0.],
               [0., 0., 0., 1., 0., 0., 0., 0., 0., 0.],
               [0., 1., 0., 0., 0., 0., 0., 0., 0., 0.]], dtype=float32)
        ```
        
- Creating the Model
    - Instantiating the Model
        
        ```python
        from tensorflow.keras.models import Sequential
        
        model = Sequential()
        ```
        
    - Creating the Input Layer
        
        ```python
        from tensorflow.keras.layers. import Dense
        
        #512Í∞úÏùò Îâ¥Îü∞ÏùÑ Í∞ÄÏßÑ ÌïòÎÇòÏùò hidden layer ÏÇ¨Ïö©, reLu function ÏÇ¨Ïö©,
        model.add(Dense(units=512, activation='relu', input_shape(784,)))
        ```
        
    - Creating the Hidden Layer
        
        ```python
        model.add(Dense(units = 512, activation='relu'))
        ```
        
    - Creating the Ouput Layer
        
        ```python
        # softmax: Í≤∞Í≥ºÍ∞íÏù¥ [0,1]Ïù¥ ÎêòÎèÑÎ°ù ÌïòÎäîÎç∞ ÎßåÏïΩ Ïπ¥ÌÖåÍ≥†Î¶¨Í∞Ä 10Í∞úÎùºÎ©¥ [1,10]
        # ÌòÑÏû¨ ÏÜêÍ∏ÄÏî®Îäî 0Î∂ÄÌÑ∞ 9ÍπåÏßÄ Ï¶â, 10Í∞úÏùò Ï∂úÎ†• Ïπ¥ÌÖåÍ≥†Î¶¨Í∞Ä ÏûàÎã§. Îî∞ÎùºÏÑú softmax Ìï®ÏàòÎ•º ÌÜµÍ≥ºÌïú Í≤∞Í≥ºÎäî Í∞Å ÌÅ¥ÎûòÏä§Ïóê ÏÜçÌï† ÌôïÎ•†Î°ú Ìï¥ÏÑùÎêúÎã§.
        model.add(Dense(units = num_classes, activation='softmax'))
        ```
        
    - Mode Summary
        
        ```python
        model.summary()
        ```
        
        <img width="695" alt="image" src="https://github.com/Dororo99/nvidia_dli/assets/136609617/77729aa4-428e-4345-9362-51b3fbe49ad5">

        
- Compiling the Model
    - loss functionÏóê Ïñ¥Îñ§Í≤ÉÏùÑ ÏÇ¨Ïö©ÌñàÎäîÏßÄ ÏïåÎ†§Ï£ºÍ≥† ÏñºÎßàÎÇò Ïûò ÌïôÏäµÎêòÎäîÏßÄ ÌåêÎã® Ìï† Ïàò ÏûàÏùå
        
        ```python
        model.compile(loss='categorical_crossentropy', metrics=['accuracy']
        ```
        
    - Training the Model
        
        ```python
        #By using model's fit method
        history  = model.fit(
        	x_train, y_train, epochs=5, verbose=1, validation_data=(x_valid,y_valid)
        )
        #epochs: ÏàòÌñâ ÌöüÏàò
        ```
        
        <img width="714" alt="image" src="https://github.com/Dororo99/nvidia_dli/assets/136609617/7bd70ca0-f794-4990-ba7f-cf20b26d9a4a">

        
- Clear the Memory
    
    ```python
    import IPython
    app = IPython.Application.instance()
    app.kernel.do_shutdown(True)
    ```
    

- Í∞ÑÎã®Ìïú Ïã§Ïäµ
    
    ```python
    import numpy as np
    from numpy.polynomial.polynomial import polyfit
    import matplotlib.pyplot as plt
    
    m = 8  # -2 to start, change me please
    b = 5  # 40 to start, change me please
    
    # Sample data
    x = np.array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9])
    y = np.array([10, 20, 25, 30, 40, 45, 40, 50, 60, 55])
    y_hat = x * m + b
    
    plt.plot(x, y, '.')
    plt.plot(x, y_hat, '-')
    plt.show()
    
    print("Loss:", np.sum((y - y_hat)**2)/len(x))
    ```
    
    <img width="726" alt="image" src="https://github.com/Dororo99/nvidia_dli/assets/136609617/daef66aa-b0ea-4e36-bba0-5a4cbcadf780">
